<style>

    .wiki-external-guide {
        margin-top: 40px;
        padding: 20px;
        background: rgba(155, 89, 182, 0.1);
        border-left: 4px solid #9b59b6;
        border-radius: 6px;
    }

    .wiki-external-guide h3 {
        margin-top: 0;
        color: #fff;
        font-size: 1.2rem;
        margin-bottom: 10px;
    }

    .wiki-external-guide p {
        margin: 0;
        color: #e0d3f8;
    }

    .wiki-external-guide a {
        color: rgba(255, 192, 203);
        font-weight: bold;
        text-decoration: none;
        transition: color 0.3s;
    }

    .wiki-external-guide a:hover {
        color: #6a0dad;
    }

    .wiki-separator {
        margin: 30px 0;
        opacity: 0.2;
    }

    .solution-button {
        background: #9b59b6;
        color: #fff;
        border: none;
        padding: 10px 18px;
        border-radius: 6px;
        cursor: pointer;
        transition: background 0.3s;
    }

    .solution-button:hover {
        background: #6a0dad;
    }

    .solution-box {
        display: none;
        margin-top: 20px;
        background: rgba(46, 204, 113, 0.15);
        padding: 20px;
        border-radius: 8px;
        border: 1px solid #2ecc71;
    }

</style>

<h1> File Upload Inseguro</h1>

<p><strong>Dificultad:</strong> Media</p>

<p>
    En este laboratorio debes explotar una vulnerabilidad de <strong>subida de archivos insegura</strong>.
</p>

<p>
    La aplicaci贸n permite subir archivos con extensi贸n <code>.jpg</code>, pero no valida correctamente
    el contenido real del archivo.
</p>

<hr class="wiki-separator">

<h2> 驴Qu茅 est谩 pasando?</h2>

<p>
    Muchas aplicaciones solo comprueban la <strong>extensi贸n del archivo</strong> y no su contenido real.
</p>

<p>
    Si el servidor 煤nicamente revisa que el nombre termine en <code>.jpg</code>,
    podr铆as intentar subir un archivo que contenga c贸digo ejecutable disfrazado como imagen.
</p>

<p>
    En servidores mal configurados, esto puede permitir la ejecuci贸n remota de c贸digo.
</p>

<hr class="wiki-separator">

<h2> Objetivo</h2>

<p>
    Vulnerar el sistema de subida de archivos utilizando tu webshell:
</p>

<pre>
shell.php
</pre>

<p>
    Debes conseguir que el servidor acepte el archivo aunque solo permita <code>.jpg</code>.
</p>

<hr class="wiki-separator">

<h2> Soluci贸n</h2>

<button onclick="document.getElementById('solucion-upload').style.display='block'; this.style.display='none';"
        class="solution-button">
    Mostrar soluci贸n
</button>

<div id="solucion-upload" class="solution-box">

    <p><strong>Nombre de archivo utilizado:</strong></p>

    <pre>
shell.php.jpg
    </pre>

    <p>
        Al a帽adir <code>.jpg</code> al final, el sistema valida la extensi贸n como imagen,
        pero el servidor puede interpretar el archivo como PHP dependiendo de su configuraci贸n.
    </p>

    <p>
        Esto demuestra que confiar 煤nicamente en la extensi贸n del archivo no es una medida de seguridad v谩lida.
    </p>

</div>

<hr class="wiki-separator">

<h2> 驴C贸mo se previene?</h2>

<ul>
    <li>Validar el tipo MIME real del archivo</li>
    <li>Revisar el contenido del archivo (magic bytes)</li>
    <li>Renombrar archivos subidos con nombres aleatorios</li>
    <li>Almacenar archivos fuera del directorio p煤blico</li>
    <li>Deshabilitar la ejecuci贸n de c贸digo en carpetas de subida</li>
</ul>

<div class="wiki-external-guide">
    <h3> M谩s informaci贸n</h3>
    <p>
        Consulta la gu铆a profesional de PortSwigger para profundizar en esta vulnerabilidad:
        <a href="https://portswigger.net/web-security/file-upload" target="_blank">
            Ver gu铆a completa
        </a>
    </p>
</div>
